"use strict";Object.defineProperty(exports,"__esModule",{value:!0});function getGlobalScope(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unexpected runtime environment - no supported global scope (`window`, `self`, `global`) available")}function arrayBufferToUint8(e){if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Non array buffer passed to arrayBufferToUint8")}function getAPIUsageErrorMessage(e,t,r){return r?`Use of '${r}' requires \`${t}\` which is unavailable on the '${e}' object within the currently executing environment.`:`\`${t}\` is unavailable on the '${e}' object within the currently executing environment.`}function getGlobalObject(e,{throwIfUnavailable:t,usageDesc:r,returnEmptyObject:n}={}){let o;try{if(o=getGlobalScope(),o){const i=o[e];if(i)return i}}catch(i){console.error(`Error getting object '${e}' from global scope '${o}': ${i}`)}if(t){const i=getAPIUsageErrorMessage(o,e.toString(),r);throw console.error(i),new Error(i)}if(n)return{}}function concatByteArrays(e){const t=e.reduce((o,i)=>o+i.length,0),r=new Uint8Array(t);let n=0;for(let o=0;o<e.length;o++)r.set(e[o],n),n+=e[o].length;return r}function ensureUint8Array(e){return typeof e=="object"&&(e=Uint8Array.from(e)),e}const BN_WORD_SIZE=26;function isBN(e){var t;return e!==null&&typeof e=="object"&&((t=e==null?void 0:e.constructor)==null?void 0:t.wordSize)===BN_WORD_SIZE&&Array.isArray(e==null?void 0:e.words)}function utf8ToBytes(e){return new TextEncoder().encode(e)}function bytesToUtf8(e){return new TextDecoder().decode(e)}const byteToHexCache=new Array(255);for(let e=0;e<=255;++e)byteToHexCache[e]=e.toString(16).padStart(2,"0");function hexToBytes(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error(`hexToBytes: received invalid unpadded hex, got: ${e.length}`);const t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){const n=r*2;t[r]=Number.parseInt(e.slice(n,n+2),16)}return t}function bytesToHex(e){const t=new Array(e.length);for(let r=0;r<e.length;++r)t[r]=byteToHexCache[e[r]];return t.join("")}function numberToHex(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function hexToBigInt(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}const intToHexString=(e,t=8)=>(typeof e=="bigint"?e:intToBigInt(e,!1)).toString(16).padStart(t*2,"0"),hexStringToInt=e=>parseInt(e,16),hexToJSON=e=>JSON.parse(bytesToUtf8(hexToBytes(e))),ensureHexBytes=e=>typeof e=="string"?hexToBytes(e):e,cleanHex=e=>e.startsWith("0x")?e.replace("0x",""):e,_0n=BigInt(0),_1n=BigInt(1);function toTwos(e,t=128){if(e<-(_1n<<BigInt(t)-_1n)||e>(_1n<<BigInt(t)-_1n)-_1n)throw`Integer out of range given ${t} bits to represent.`;return e>=_0n?e:~(-e-_1n|~((_1n<<BigInt(t))-_1n))}function fromTwos(e,t=128){return(e&_1n<<BigInt(t)-_1n)>_0n&&(e=e-(_1n<<BigInt(t))),e}function intToBytes(e,t=!1,r=8){return hexToBytes(intToHexString(intToBigInt(e,t),r))}function intToHex(e,t=!1,r=8){return intToHexString(intToBigInt(e,t),r)}function intToBigInt(e,t=!1){if(typeof e=="number"){if(!Number.isInteger(e))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");return BigInt(e)}if(typeof e=="string")if(e.toLowerCase().startsWith("0x")){let r=e.slice(2);r=r.padStart(r.length+r.length%2,"0"),e=hexToBytes(r)}else try{return BigInt(e)}catch(r){if(r instanceof SyntaxError)throw new RangeError(`Invalid value. String integer '${e}' is not finite.`)}if(typeof e=="bigint")return e;if(e instanceof Uint8Array)return t?fromTwos(hexToBigInt(bytesToHex(e))):hexToBigInt(bytesToHex(e));if(isBN(e))return BigInt(e.toString());throw new TypeError(`Invalid value type. Must be a number, bigint, integer-string, hex-string, BN.js instance, or Buffer, got: ${typeof e}.`)}const bytesToBigInt=e=>hexToBigInt(bytesToHex(e));function wrapMessage(e){return`[micro-stacks] ${e}`}class StacksTransactionError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class SerializationError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class DeserializationError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class NotImplementedError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class SigningError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class VerificationError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class MissingParametersError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name}}class InvalidTokenError extends Error{constructor(t){super(t);this.message=wrapMessage(t),this.name=this.constructor.name}}function deepCopy(e){switch(typeof e){case"string":case"number":case"bigint":case"boolean":case"undefined":case"symbol":case"function":return e}if(e===null)return e;if(ArrayBuffer.isView(e))return e.slice();if(e instanceof Date)return new Date(e);if(e instanceof Array)return e.reduce((t,r,n)=>(t[n]=deepCopy(r),t),[]);if(e instanceof Object)return Object.keys(e).reduce((t,r)=>(t[r]=deepCopy(e[r]),t),Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e)))}function cloneDeep(e){return deepCopy(e)}function omit(e,t){const r=cloneDeep(e);return delete r[t],r}var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e};const isClientSide=typeof window!="undefined",DEFAULT_FETCH_OPTIONS=isClientSide?{referrer:"no-referrer",referrerPolicy:"no-referrer"}:{};async function fetchPrivate(e,t={}){return fetch(e,__spreadValues(__spreadValues({},DEFAULT_FETCH_OPTIONS),t))}const base64Code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64urlCode="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function getLens(e){const t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");let r=e.indexOf("=");r===-1&&(r=t);const n=r===t?0:4-r%4;return[r,n]}function byteLength(e){const t=getLens(e),r=t[0],n=t[1];return(r+n)*3/4-n}function _byteLength(e,t,r){return(t+r)*3/4-r}function base64ToBytesBase(e,t){const{revLookup:r}=getBase64Lookup(t);let n;const o=getLens(e),i=o[0],s=o[1],u=new Uint8Array(_byteLength(e,i,s));let c=0;const f=s>0?i-4:i;let a;for(a=0;a<f;a+=4)n=r[e.charCodeAt(a)]<<18|r[e.charCodeAt(a+1)]<<12|r[e.charCodeAt(a+2)]<<6|r[e.charCodeAt(a+3)],u[c++]=n>>16&255,u[c++]=n>>8&255,u[c++]=n&255;return s===2&&(n=r[e.charCodeAt(a)]<<2|r[e.charCodeAt(a+1)]>>4,u[c++]=n&255),s===1&&(n=r[e.charCodeAt(a)]<<10|r[e.charCodeAt(a+1)]<<4|r[e.charCodeAt(a+2)]>>2,u[c++]=n>>8&255,u[c++]=n&255),u}function padString(e){const t=4,r=e.length,n=r%t;if(!n)return e;const o=t-n,i=r+o;return e.padEnd(i,"=")}function base64ToBytes(e){return base64ToBytesBase(padString(e),base64Code)}function base64UrlToBytes(e){return base64ToBytesBase(padString(e),base64urlCode)}function tripletToBase64(e,t){const{lookup:r}=getBase64Lookup(t);return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[e&63]}function encodeChunk(e,t,r,n){let o;const i=[];for(let s=t;s<r;s+=3)o=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(e[s+2]&255),i.push(tripletToBase64(o,n));return i.join("")}const cacheMap=new Map;function getBase64Lookup(e){if(cacheMap.has(e))return cacheMap.get(e);const t=[],r=[];for(let n=0,o=e.length;n<o;++n)t[n]=e[n],r[e.charCodeAt(n)]=n;return r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63,cacheMap.set(e,{lookup:t,revLookup:r}),{lookup:t,revLookup:r}}function bytesToBase64Base(e,t){const{lookup:r}=getBase64Lookup(t);let n;const o=e.length,i=o%3,s=[],u=16383;for(let c=0,f=o-i;c<f;c+=u)s.push(encodeChunk(e,c,c+u>f?f:c+u,t));return i===1?(n=e[o-1],s.push(r[n>>2]+r[n<<4&63]+"==")):i===2&&(n=(e[o-2]<<8)+e[o-1],s.push(r[n>>10]+r[n>>4&63]+r[n<<2&63]+"=")),s.join("")}function bytesToBase64(e){return bytesToBase64Base(e,base64Code)}function bytesToBase64Url(e){return bytesToBase64Base(e,base64urlCode)}/*! micro-base58 - MIT License (c) 2021, Paul Miller (https://paulmillr.com) */const B58_ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",_58n=BigInt(58);function encodeB58(e){if(e.length===0)return"";typeof e=="string"&&(typeof TextEncoder!="undefined"?e=new TextEncoder().encode(e):e=new Uint8Array(e.split("").map(n=>n.charCodeAt(0))));let t=BigInt("0x"+bytesToHex(e));const r=[];for(;t>0;){const n=Number(t%_58n);t=t/_58n,r.push(B58_ALPHABET[n])}for(let n=0;e[n]===0;n++)r.push(B58_ALPHABET[0]);return r.reverse().join("")}function decodeB58(e){if(e.length===0)return new Uint8Array([]);const t=[0];for(let r=0;r<e.length;r++){const n=e[r],o=B58_ALPHABET.indexOf(n);if(o===void 0)throw new Error(`base58.decode received invalid input. Character '${n}' is not in the base58 alphabet.`);for(let s=0;s<t.length;s++)t[s]*=58;t[0]+=o;let i=0;for(let s=0;s<t.length;s++)t[s]+=i,i=t[s]>>8,t[s]&=255;for(;i>0;)t.push(i&255),i>>=8}for(let r=0;r<e.length&&e[r]==="1";r++)t.push(0);return new Uint8Array(t.reverse())}function asciiToBytes(e){const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r)&255);return new Uint8Array(t)}function bytesToAscii(e){let t="";const r=e.length;for(let n=0;n<r;++n)t+=String.fromCharCode(e[n]&127);return t}function copy(e,t,r,n,o){if(n||(n=0),!o&&o!==0&&(o=e.length),r>=t.length&&(r=t.length),r||(r=0),o>0&&o<n&&(o=n),o===n||t.length===0||e.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=e.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>e.length&&(o=e.length),t.length-r<o-n&&(o=t.length-r+n);const i=o-n;return e===t&&typeof Uint8Array.prototype.copyWithin=="function"?e.copyWithin(r,n,o):Uint8Array.prototype.set.call(t,e.subarray(n,o),r),i}class BufferArray{constructor(){this._value=[]}get value(){return this._value}appendHexString(t){this.value.push(hexToBytes(t))}push(t){return this._value.push(t)}appendByte(t){if(!Number.isInteger(t)||t<0||t>255)throw new Error(`Value ${t} is not a valid byte`);this.value.push(Uint8Array.from([t]))}concatBuffer(){return concatByteArrays(this.value)}}const ERRORS={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};function writeUInt8(e,t,r){return t=+t,r=r>>>0,e[r]=t&255,r+1}function writeUInt16BE(e,t,r){return t=+t,r=r>>>0,e[r]=t>>>8,e[r+1]=t&255,r+2}function readUInt8(e,t){return t=t>>>0,e[t]}function readInt32LE(e,t){return t>>>=0,e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function readUInt32BE(e,t){return t=t>>>0,e[t]*16777216+(e[t+1]<<16|e[t+2]<<8|e[t+3])}function writeUInt32LE(e,t,r){return t=+t,r>>>=0,e[r+3]=t>>>24,e[r+2]=t>>>16,e[r+1]=t>>>8,e[r]=t&255,r+4}function writeInt32LE(e,t,r){return t=+t,r>>>=0,e[r]=t&255,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,r+4}function writeUInt32BE(e,t,r){return t=+t,r>>>=0,e[r]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t&255,r+4}function isInstance(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function compare(e,t){if(!isInstance(e,Uint8Array)||!isInstance(t,Uint8Array))throw new TypeError('The "buf1", "buf2" arguments must be one of type Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0}function readBuffer(e,t){const r=typeof t=="number"?t:e.length,n=Math.min(e.length,e.byteOffset+r);return e.slice(e.byteOffset,n)}function createEnumChecker(e){const t=Object.values(e).filter(n=>typeof n=="number"),r=new Set(t);return n=>r.has(n)}const enumCheckFunctions=new Map;function isEnum(e,t){const r=enumCheckFunctions.get(e);if(r!==void 0)return r(t);const n=createEnumChecker(e);return enumCheckFunctions.set(e,n),isEnum(e,t)}function isInteger(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}function isFiniteInteger(e){return typeof e=="number"&&isFinite(e)&&isInteger(e)}function checkOffsetOrLengthValue(e,t){if(typeof e=="number"){if(!isFiniteInteger(e)||e<0)throw new Error(t?ERRORS.INVALID_OFFSET:ERRORS.INVALID_LENGTH)}else throw new Error(t?ERRORS.INVALID_OFFSET_NON_NUMBER:ERRORS.INVALID_LENGTH_NON_NUMBER)}class BufferReader{constructor(t){if(this._readOffset=0,t)this.buffer=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength);else{const r=new Uint8Array;this.buffer=r,this.view=new DataView(r.buffer,r.byteOffset,r.byteLength)}}ensureReadable(t,r){let n=this._readOffset;if(typeof r!="undefined"&&(checkOffsetOrLengthValue(r,!0),n=r),n<0||n+t>this.buffer.length)throw new Error(ERRORS.INVALID_READ_BEYOND_BOUNDS)}_readNumberValue(t,r,n){this.ensureReadable(r,n);const o=t.call(this.view,typeof n=="number"?n:this._readOffset);return typeof n=="undefined"&&(this._readOffset+=r),o}readBuffer(t){const r=typeof t=="number"?t:this.buffer.length,n=Math.min(this.buffer.length,this._readOffset+r),o=this.buffer.slice(this.buffer.byteOffset+this._readOffset,n);return this._readOffset=n,o}readUInt32BE(t){return this._readNumberValue(this.view.getUint32,4,t)}readUInt8(t){return this._readNumberValue(this.view.getUint8,1,t)}readUInt16BE(t){return this._readNumberValue(this.view.getUint16,2,t)}readBigUIntLE(t){const r=Uint8Array.from(this.readBuffer(t)).reverse(),n=bytesToHex(r);return BigInt(`0x${n}`)}readBigUIntBE(t){const r=this.readBuffer(t),n=bytesToHex(r);return BigInt(`0x${n}`)}readBigUInt64BE(t){if(typeof BigInt=="undefined")throw new Error("Platform does not support JS BigInt type.");return this._readNumberValue(this.view.getBigUint64,8,t)}get readOffset(){return this._readOffset}set readOffset(t){this._readOffset=t}get internalBuffer(){return this.buffer.buffer}readUInt8Enum(t,r){const n=this.readUInt8();if(isEnum(t,n))return n;throw r(n)}}exports.ChainID=void 0,function(e){e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet"}(exports.ChainID||(exports.ChainID={}));const DEFAULT_CHAIN_ID=1;exports.TransactionVersion=void 0,function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"}(exports.TransactionVersion||(exports.TransactionVersion={})),exports.BufferArray=BufferArray,exports.BufferReader=BufferReader,exports.DEFAULT_CHAIN_ID=DEFAULT_CHAIN_ID,exports.DeserializationError=DeserializationError,exports.ERRORS=ERRORS,exports.InvalidTokenError=InvalidTokenError,exports.MissingParametersError=MissingParametersError,exports.NotImplementedError=NotImplementedError,exports.SerializationError=SerializationError,exports.SigningError=SigningError,exports.StacksTransactionError=StacksTransactionError,exports.VerificationError=VerificationError,exports.arrayBufferToUint8=arrayBufferToUint8,exports.asciiToBytes=asciiToBytes,exports.base64ToBytes=base64ToBytes,exports.base64ToBytesBase=base64ToBytesBase,exports.base64UrlToBytes=base64UrlToBytes,exports.byteLength=byteLength,exports.bytesToAscii=bytesToAscii,exports.bytesToBase64=bytesToBase64,exports.bytesToBase64Base=bytesToBase64Base,exports.bytesToBase64Url=bytesToBase64Url,exports.bytesToBigInt=bytesToBigInt,exports.bytesToHex=bytesToHex,exports.bytesToUtf8=bytesToUtf8,exports.checkOffsetOrLengthValue=checkOffsetOrLengthValue,exports.cleanHex=cleanHex,exports.cloneDeep=cloneDeep,exports.compare=compare,exports.concatByteArrays=concatByteArrays,exports.copy=copy,exports.decodeB58=decodeB58,exports.encodeB58=encodeB58,exports.ensureHexBytes=ensureHexBytes,exports.ensureUint8Array=ensureUint8Array,exports.fetchPrivate=fetchPrivate,exports.fromTwos=fromTwos,exports.getGlobalObject=getGlobalObject,exports.hexStringToInt=hexStringToInt,exports.hexToBigInt=hexToBigInt,exports.hexToBytes=hexToBytes,exports.hexToJSON=hexToJSON,exports.intToBigInt=intToBigInt,exports.intToBytes=intToBytes,exports.intToHex=intToHex,exports.intToHexString=intToHexString,exports.isEnum=isEnum,exports.isFiniteInteger=isFiniteInteger,exports.isInteger=isInteger,exports.numberToHex=numberToHex,exports.omit=omit,exports.readBuffer=readBuffer,exports.readInt32LE=readInt32LE,exports.readUInt32BE=readUInt32BE,exports.readUInt8=readUInt8,exports.toTwos=toTwos,exports.utf8ToBytes=utf8ToBytes,exports.writeInt32LE=writeInt32LE,exports.writeUInt16BE=writeUInt16BE,exports.writeUInt32BE=writeUInt32BE,exports.writeUInt32LE=writeUInt32LE,exports.writeUInt8=writeUInt8;
